<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>CashPath ‚Äî –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
<h1>CashPath ‚Äî –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ</h1>

<!-- Showing game page with full players info -->
<div id="gameContainer">
    <h3>–î–µ–Ω—å: <span th:text="${data.game.currentDay}"></span>
        <span> –•–æ–¥ –∏–≥—Ä–æ–∫–∞: </span>
        <span id="activePlayerName" th:text="${data.currentPlayer.name}"></span>
        <span> GameID: </span>
        <span id="game_Id" th:text="${data.game.id}"></span>
    </h3>

    <div class="players-row">
        <div class="player player-card" th:each="player : ${data.players}" th:attr="id='player_' + ${player.id}">
            <h3 class="playerName" th:text="${player.name}">–ò–≥—Ä–æ–∫</h3>
            <p>üí∞ –ù–∞–ª–∏—á–Ω—ã–µ: <span id="cash_" th:attr="id='cash_' + ${player.id}" th:text="${player.cash}">0.0</span> ‚Ç¥</p>
            <p>üíº –ó–∞—Ä–ø–ª–∞—Ç–∞: <b th:text="${#numbers.formatDecimal(player.salary, 1, 2)}"></b> ‚Ç¥</p>
            <p>üìâ –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã: <b th:text="${#numbers.formatDecimal(player.monthlyExpenses, 1, 2)}"></b> ‚Ç¥</p>
            <p>üìà –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥: <span id="dailyCashFlow_" th:attr="id='dailyCashFlow_' + ${player.id}" th:text="${player.dailyCashFlow}">0.0</span> ‚Ç¥</p>

            <h4>–ü–∞—Å—Å–∏–≤—ã:</h4>
            <table>
                <thead><tr><th>–ü–ª–∞—Ç—ë–∂</th></tr></thead>
                <tbody>
                <tr th:each="l : ${player.liabilities}">
                    <td th:text="${l.name}"></td>
                    <td th:text="${#numbers.formatDecimal(l.monthlyPayment, 1, 2)}"></td>
                </tr>
                </tbody>
            </table>
            <!-- Current ooportunity card -->
            <div id="cardInfo" class="cardInfo"
                 th:if="${player.id == data.currentPlayer.id}"
                 style="margin-top:20px;padding:15px;border:2px solid #4CAF50;border-radius:10px;background:#f9fff9;">
                <h3>üéØ –¢–µ–∫—É—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏</h3>
                <p>–ù–∞–∑–≤–∞–Ω–∏–µ: <span id="cardDescription" th:text="${data.card.description}">–ù–µ—Ç</span></p>
                <p>–°—Ç–æ–∏–º–æ—Å—Ç—å: <span id="cardPrice" th:text="${data.card.price}">0.0</span> ‚Ç¥</p>
            </div>
        </div>
    </div>
</div>
<div style="clear: both;"></div>

<div id="controls">
    <div style="margin-top: 20px;">
        <button id="buyButton" class="btn">–°–¥–µ–ª–∞—Ç—å –ø–æ–∫—É–ø–∫—É</button>
    </div>
    <div style="margin-top: 10px;">
        <button id="endTurnButton" class="btn">–ó–∞–∫–æ–Ω—á–∏—Ç—å —Ö–æ–¥</button>
    </div>
</div>

<div id="spinner" class="spinner" style="display:none;">
    <div class="bounce1"></div>
    <div class="bounce2"></div>
    <div class="bounce3"></div>
    <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
</div>

<!-- Log -->
<div th:if="${log}" class="log-box">
    <h3>üßæ –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ö–æ–¥–∞:</h3>
    <div th:text="${log}"></div>
</div>

<script th:inline="javascript">
    const GAME_ID = /*[[${data.game.id}]]*/ 0;
    console.log("gameID:", GAME_ID);
    let cardId = /*[[${data.card.id}]]*/ -1;
</script>
<script src="/game.js"></script>
</body>
</html>