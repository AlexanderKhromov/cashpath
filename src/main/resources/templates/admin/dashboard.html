<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin panel</title>
</head>
<body>

<h2>Games</h2>

<form th:action="@{/admin/games/delete}" method="post">
    <table border="1">
        <thead>
        <tr>
            <th><input type="checkbox" onclick="toggleAll(this)"></th>
            <th>ID</th>
            <th>Status</th>
            <th>Current day</th>
            <th>Players</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="game : ${games}">
            <td><input type="checkbox" name="gameIds" th:value="${game.id}"></td>
            <td th:text="${game.id}"></td>
            <td th:text="${game.status}"></td>
            <td th:text="${game.currentDay}"></td>
            <td th:text="${#lists.size(game.players)}"></td>
        </tr>
        </tbody>
    </table>

    <button type="submit"
            onclick="return confirm('Удалить выбранные игры?')">
        Удалить выбранные игры
    </button>
</form>

<hr/>

<h2>Players / Assets / Liabilities</h2>

<div th:each="player : ${players}" style="margin-bottom:30px;">
    <h3>
        Player:
        <span th:text="${player.name}"></span>
        (ID: <span th:text="${player.id}"></span>)
    </h3>

    <form th:action="@{/admin/players/{id}/positions/delete(id=${player.id})}"
          method="post"
          th:object="${player}">

        <h4>Assets</h4>
        <table border="1">
            <thead>
            <tr>
                <th></th>
                <th>Name</th>
                <th>Daily cash flow</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="asset : ${player.assets}">
                <td>
                    <input type="checkbox"
                           name="assetIds"
                           th:value="${asset.id}">
                </td>
                <td th:text="${asset.name}"></td>
                <td th:text="${asset.dailyCashFlow}"></td>
            </tr>
            </tbody>
        </table>

        <h4>Liabilities</h4>
        <table border="1">
            <thead>
            <tr>
                <th></th>
                <th>Name</th>
                <th>Daily payment</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="liability : ${player.liabilities}">
                <td>
                    <input type="checkbox"
                           name="liabilityIds"
                           th:value="${liability.id}">
                </td>
                <td th:text="${liability.name}"></td>
                <td th:text="${liability.dailyPayment}"></td>
            </tr>
            </tbody>
        </table>

        <br/>

        <button type="submit"
                onclick="return confirm('Удалить выбранные активы и пассивы?')">
            Удалить выбранные позиции
        </button>
    </form>

    <hr/>
</div>

<script>
    function toggleAll(source) {
        document.querySelectorAll('input[name="gameIds"]')
            .forEach(cb => cb.checked = source.checked);
    }
</script>

</body>
</html>
